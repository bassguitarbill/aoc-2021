import Data.Char
import Data.List

testData =  "00100\n\
            \11110\n\
            \10110\n\
            \10111\n\
            \10101\n\
            \01111\n\
            \00111\n\
            \11100\n\
            \10000\n\
            \11001\n\
            \00010\n\
            \01010"

realData =  "110011110101\n\
            \110011100010\n\
            \010100011010\n\
            \011001100000\n\
            \010011011101\n\
            \011110111000\n\
            \111111000100\n\
            \000100010001\n\
            \101101010011\n\
            \100101101100\n\
            \001111011010\n\
            \011111111101\n\
            \010111000000\n\
            \000011101000\n\
            \100101010010\n\
            \010011000010\n\
            \000011000000\n\
            \111100110010\n\
            \100100101110\n\
            \110000110100\n\
            \011110010000\n\
            \010101000000\n\
            \001000110001\n\
            \010111000100\n\
            \110111010100\n\
            \011001110110\n\
            \110001001101\n\
            \001101010010\n\
            \110111110100\n\
            \100111110111\n\
            \001001110010\n\
            \001100011111\n\
            \001111110010\n\
            \100111000111\n\
            \101111100001\n\
            \011100001100\n\
            \000000000111\n\
            \101111110001\n\
            \110111001101\n\
            \101111011010\n\
            \100101001111\n\
            \011101111111\n\
            \101101010101\n\
            \011011111000\n\
            \011100101001\n\
            \001101010100\n\
            \000011101010\n\
            \010100111000\n\
            \000111011100\n\
            \110000100101\n\
            \110110011000\n\
            \111001000110\n\
            \110001000100\n\
            \110111001100\n\
            \010111011111\n\
            \110110101001\n\
            \101000001011\n\
            \100001001010\n\
            \001011000011\n\
            \000100101111\n\
            \000001111010\n\
            \001010110110\n\
            \000010110001\n\
            \011011011001\n\
            \110010001011\n\
            \101111001100\n\
            \101000101100\n\
            \011010101100\n\
            \000111000001\n\
            \010001000010\n\
            \011111101011\n\
            \101101011000\n\
            \100010100100\n\
            \100010011001\n\
            \100010010100\n\
            \011010110000\n\
            \111001111011\n\
            \000000101000\n\
            \011010110001\n\
            \111110001110\n\
            \010010001100\n\
            \101000100100\n\
            \000110111010\n\
            \000100011000\n\
            \011100110110\n\
            \010000000100\n\
            \010001000001\n\
            \010011001010\n\
            \111100101010\n\
            \010110110110\n\
            \010100111111\n\
            \000010001010\n\
            \111110001101\n\
            \110000100010\n\
            \110111010110\n\
            \101011100001\n\
            \111111010001\n\
            \101111111000\n\
            \100110111101\n\
            \110000100110\n\
            \010101100011\n\
            \101111010101\n\
            \101010101011\n\
            \101010100011\n\
            \000100111001\n\
            \001001101001\n\
            \110001000001\n\
            \001011000110\n\
            \111110101011\n\
            \101100101111\n\
            \111001111001\n\
            \101100010101\n\
            \011011100100\n\
            \100110010110\n\
            \101110011111\n\
            \011001010011\n\
            \111111111111\n\
            \110111000000\n\
            \011010101011\n\
            \011111100001\n\
            \100100001001\n\
            \011111100010\n\
            \111111001001\n\
            \100011110111\n\
            \110000101100\n\
            \111001101001\n\
            \011110111101\n\
            \011010101111\n\
            \101011000101\n\
            \000010110011\n\
            \100100011011\n\
            \010000001001\n\
            \001100110111\n\
            \111011001111\n\
            \101101011001\n\
            \110111111000\n\
            \100100100110\n\
            \110011011010\n\
            \011111010010\n\
            \011000110001\n\
            \001001110011\n\
            \111110100111\n\
            \100001010011\n\
            \110011011101\n\
            \100000011100\n\
            \001001010010\n\
            \111010110000\n\
            \001111110000\n\
            \110000000011\n\
            \110111100010\n\
            \100101010001\n\
            \010110000110\n\
            \100010001010\n\
            \001110110101\n\
            \011100000001\n\
            \010100100011\n\
            \110001011011\n\
            \010000110100\n\
            \001011010110\n\
            \011000100010\n\
            \001111100000\n\
            \100101001100\n\
            \110000000000\n\
            \011001101110\n\
            \111110010100\n\
            \111001010111\n\
            \011000100000\n\
            \110000010010\n\
            \000110001001\n\
            \101000101101\n\
            \010010101110\n\
            \110001010010\n\
            \110010001101\n\
            \110111001110\n\
            \100100100100\n\
            \011010000100\n\
            \101001000110\n\
            \000000000000\n\
            \001000000100\n\
            \101011100110\n\
            \100010010110\n\
            \101110000101\n\
            \011010110100\n\
            \000000110010\n\
            \100110101000\n\
            \100011100011\n\
            \110100010110\n\
            \011111001011\n\
            \011010111011\n\
            \011001110100\n\
            \110111001001\n\
            \011110101000\n\
            \100011101010\n\
            \101001000100\n\
            \001000101111\n\
            \010111101000\n\
            \001110101000\n\
            \110100011000\n\
            \000100111110\n\
            \000111110000\n\
            \011111110100\n\
            \100000111010\n\
            \001111011100\n\
            \110100101101\n\
            \000110000110\n\
            \001010100011\n\
            \011100100111\n\
            \101101110111\n\
            \010110000001\n\
            \000001100111\n\
            \110000101010\n\
            \100001010101\n\
            \001000111110\n\
            \101011110101\n\
            \011111100100\n\
            \100000100101\n\
            \000101011111\n\
            \011010101010\n\
            \011010110110\n\
            \000001110000\n\
            \110100101011\n\
            \110010101110\n\
            \111110110011\n\
            \110110001110\n\
            \010011000100\n\
            \100101111101\n\
            \101111100110\n\
            \101111101110\n\
            \001000001000\n\
            \011111011010\n\
            \111010101010\n\
            \111111000101\n\
            \010110001000\n\
            \011110000100\n\
            \110101001110\n\
            \101110000011\n\
            \110000100100\n\
            \010010001001\n\
            \100110001110\n\
            \101000001000\n\
            \010111011110\n\
            \000011111110\n\
            \010001101111\n\
            \100010011110\n\
            \111000100111\n\
            \010101110010\n\
            \001000000111\n\
            \010010011010\n\
            \010100011100\n\
            \101001011100\n\
            \000010110101\n\
            \100010110110\n\
            \110111011000\n\
            \011101110001\n\
            \110011000110\n\
            \000010011111\n\
            \000001011011\n\
            \100111011011\n\
            \111110111100\n\
            \110100000010\n\
            \010110001110\n\
            \011110000110\n\
            \100111011100\n\
            \111111110111\n\
            \000001000100\n\
            \111101000101\n\
            \101110100101\n\
            \011010001101\n\
            \001001100101\n\
            \001011110101\n\
            \100110011011\n\
            \010111100101\n\
            \010101011111\n\
            \000000001001\n\
            \100100110001\n\
            \101111111110\n\
            \101010110001\n\
            \110010011010\n\
            \010001111010\n\
            \001001110101\n\
            \000111110111\n\
            \010101001000\n\
            \011110101101\n\
            \100001101100\n\
            \111010000010\n\
            \001110110000\n\
            \101110111111\n\
            \000110110000\n\
            \000111000100\n\
            \101010101101\n\
            \111001111000\n\
            \001011111101\n\
            \101111010110\n\
            \111110100011\n\
            \111011111010\n\
            \010101001111\n\
            \101100110110\n\
            \001100000001\n\
            \110101110010\n\
            \100010001011\n\
            \110000110111\n\
            \000101010000\n\
            \010011111001\n\
            \010001100000\n\
            \111110011101\n\
            \101101001001\n\
            \001111101111\n\
            \001101000101\n\
            \001000010011\n\
            \100001101101\n\
            \111100110111\n\
            \110101111011\n\
            \100000001001\n\
            \101011110001\n\
            \001001010110\n\
            \011000110010\n\
            \011010100000\n\
            \011011100001\n\
            \000100110111\n\
            \111101110010\n\
            \000011001100\n\
            \100000000000\n\
            \111110110111\n\
            \001100000101\n\
            \000001100000\n\
            \000011001110\n\
            \111010011011\n\
            \110111111010\n\
            \100011101110\n\
            \000110111001\n\
            \111010110101\n\
            \010001011001\n\
            \011011111111\n\
            \111101001011\n\
            \001111110001\n\
            \110100001110\n\
            \101000100001\n\
            \101011001111\n\
            \100101101010\n\
            \001110100000\n\
            \011010110011\n\
            \001011001101\n\
            \111111100011\n\
            \111110101100\n\
            \010001001011\n\
            \001110100011\n\
            \010000111010\n\
            \010110101111\n\
            \000001101001\n\
            \001011110000\n\
            \011010011101\n\
            \111000111010\n\
            \110100011010\n\
            \111100000010\n\
            \110101100100\n\
            \110100010101\n\
            \001001101000\n\
            \011101011101\n\
            \000101101011\n\
            \011011100110\n\
            \001110010010\n\
            \001011111100\n\
            \110010001110\n\
            \001110101010\n\
            \111011111000\n\
            \101001100111\n\
            \001110101011\n\
            \010100010101\n\
            \000100101000\n\
            \001110101001\n\
            \010000000111\n\
            \010100100111\n\
            \000011111001\n\
            \001111000111\n\
            \010100101010\n\
            \110110011101\n\
            \011101001001\n\
            \010110101000\n\
            \101110100000\n\
            \010000000000\n\
            \101111111101\n\
            \000110000000\n\
            \100101000001\n\
            \010100011001\n\
            \110011001000\n\
            \010010100011\n\
            \101010001011\n\
            \100001111101\n\
            \010001111100\n\
            \011110001100\n\
            \101000111010\n\
            \000110110010\n\
            \101111100000\n\
            \001110011000\n\
            \010001110101\n\
            \000110011011\n\
            \000011001111\n\
            \101000111110\n\
            \010001100111\n\
            \011010001000\n\
            \011101010011\n\
            \110101101001\n\
            \010100000111\n\
            \111111011110\n\
            \010101101101\n\
            \011111111011\n\
            \000011111100\n\
            \101110100010\n\
            \101110110101\n\
            \100010110101\n\
            \010000100110\n\
            \101111111010\n\
            \001001001001\n\
            \111111011101\n\
            \000000011011\n\
            \011101001111\n\
            \000110000101\n\
            \011101111100\n\
            \100111001011\n\
            \110011101000\n\
            \010110101110\n\
            \110100100010\n\
            \010100110010\n\
            \100001000110\n\
            \111000001101\n\
            \000111101101\n\
            \011110011101\n\
            \110100100111\n\
            \101100101010\n\
            \010001100101\n\
            \010101111001\n\
            \001111101011\n\
            \110001011100\n\
            \000011011001\n\
            \000000110101\n\
            \101101000110\n\
            \001101110101\n\
            \101110110000\n\
            \100000110010\n\
            \000111010100\n\
            \001111110110\n\
            \010000111111\n\
            \011011101111\n\
            \010011001100\n\
            \111100011010\n\
            \011010001011\n\
            \100111101000\n\
            \010100100100\n\
            \010100100101\n\
            \010100101001\n\
            \000010010011\n\
            \101101100000\n\
            \101101101110\n\
            \010111011101\n\
            \000010110000\n\
            \100111111001\n\
            \001010100111\n\
            \000110000001\n\
            \100000111100\n\
            \001101000001\n\
            \000010110110\n\
            \011000010101\n\
            \100100110110\n\
            \100100100101\n\
            \101010110101\n\
            \010010100001\n\
            \111110001010\n\
            \011100101111\n\
            \101001001111\n\
            \101101011100\n\
            \010001010100\n\
            \101110101111\n\
            \000111001101\n\
            \011000001001\n\
            \101001100001\n\
            \110111011101\n\
            \111000010000\n\
            \011100000110\n\
            \110011011100\n\
            \000111010001\n\
            \010010011000\n\
            \111100010110\n\
            \100001111011\n\
            \001100001011\n\
            \000111000101\n\
            \100111110000\n\
            \011000101101\n\
            \100110000011\n\
            \110011100001\n\
            \000110110100\n\
            \011110011011\n\
            \011011001100\n\
            \100001101010\n\
            \100001100011\n\
            \101010110100\n\
            \010000001011\n\
            \110000111001\n\
            \101101010100\n\
            \010000110001\n\
            \111001010110\n\
            \010000011011\n\
            \101001001110\n\
            \011010001010\n\
            \000111010110\n\
            \001011100000\n\
            \111000000101\n\
            \010100111101\n\
            \010110000111\n\
            \111011100100\n\
            \000110010101\n\
            \001010111010\n\
            \101010110010\n\
            \100000001111\n\
            \000011110111\n\
            \100110001000\n\
            \110000011011\n\
            \101011100000\n\
            \110110000011\n\
            \011110110000\n\
            \101001001100\n\
            \010011000110\n\
            \011000101111\n\
            \101111010010\n\
            \101101110011\n\
            \111010010100\n\
            \000100110011\n\
            \011010011110\n\
            \110011110000\n\
            \010001001110\n\
            \110010111001\n\
            \100101111100\n\
            \101111000011\n\
            \010000011010\n\
            \111101010010\n\
            \011001110111\n\
            \001111100010\n\
            \100010010011\n\
            \110101001000\n\
            \011010010000\n\
            \001001010101\n\
            \000101010010\n\
            \100110101110\n\
            \101101010111\n\
            \111010001011\n\
            \000110111011\n\
            \110011111000\n\
            \101100011001\n\
            \010110011101\n\
            \010011000001\n\
            \001001000110\n\
            \111011010001\n\
            \011110101010\n\
            \110110011001\n\
            \111110101010\n\
            \010000100010\n\
            \010000111011\n\
            \111000100010\n\
            \000010100001\n\
            \111000000000\n\
            \111101000111\n\
            \111100101001\n\
            \111011110101\n\
            \101010010001\n\
            \111101101100\n\
            \000010100011\n\
            \000011011000\n\
            \111101011010\n\
            \101100111000\n\
            \101010000000\n\
            \010100000000\n\
            \001000000110\n\
            \111101100001\n\
            \010100001100\n\
            \110001011111\n\
            \111111100101\n\
            \000110011010\n\
            \011011110110\n\
            \100111000101\n\
            \001010111101\n\
            \000001101111\n\
            \001111101101\n\
            \001101101111\n\
            \011001111000\n\
            \011110011111\n\
            \011000111010\n\
            \001010100101\n\
            \011000001011\n\
            \001011010010\n\
            \010000101001\n\
            \100001101000\n\
            \100011101000\n\
            \101001101100\n\
            \010011011010\n\
            \011100001111\n\
            \001110000001\n\
            \101000001110\n\
            \000110011111\n\
            \111011110000\n\
            \000101100010\n\
            \011110000010\n\
            \111011111101\n\
            \011010000011\n\
            \000100110100\n\
            \000010101001\n\
            \100011000000\n\
            \001111000011\n\
            \111100001110\n\
            \110101000101\n\
            \011000100011\n\
            \101100110000\n\
            \000110010111\n\
            \101100000101\n\
            \001110100101\n\
            \000011011101\n\
            \001010111000\n\
            \000100011111\n\
            \100110000000\n\
            \011010111010\n\
            \000110000100\n\
            \011100100010\n\
            \101001011101\n\
            \110101010101\n\
            \011110001110\n\
            \100101011100\n\
            \110010011101\n\
            \111000101001\n\
            \100111101010\n\
            \001100011101\n\
            \110011111101\n\
            \100001110101\n\
            \011101000001\n\
            \011110111100\n\
            \110011000100\n\
            \101000101010\n\
            \001100110001\n\
            \011111001000\n\
            \101101111111\n\
            \010101001100\n\
            \100100101111\n\
            \000100111010\n\
            \110100101001\n\
            \100000010010\n\
            \001000010101\n\
            \110111111110\n\
            \101110111001\n\
            \110011100101\n\
            \101001111011\n\
            \101000011101\n\
            \000011100011\n\
            \011101001000\n\
            \001110111001\n\
            \001000100111\n\
            \101100010001\n\
            \110001100001\n\
            \111100110100\n\
            \001011000001\n\
            \110000110010\n\
            \100011110110\n\
            \100100111111\n\
            \101001000001\n\
            \010100110001\n\
            \010000000001\n\
            \000000111101\n\
            \100011000101\n\
            \001111010010\n\
            \010000001100\n\
            \010011011110\n\
            \100111111100\n\
            \110111000100\n\
            \100010101110\n\
            \100100000011\n\
            \100001001001\n\
            \001110110100\n\
            \001111111100\n\
            \111101000011\n\
            \100100110000\n\
            \010110001101\n\
            \001010101101\n\
            \001001111000\n\
            \000111110100\n\
            \011100010000\n\
            \001101000011\n\
            \001101100001\n\
            \000001100110\n\
            \110010100011\n\
            \111111010111\n\
            \001100010001\n\
            \001111001010\n\
            \101000111001\n\
            \000010011101\n\
            \000011111111\n\
            \001000010001\n\
            \101111010011\n\
            \011100111101\n\
            \101100001011\n\
            \011100001001\n\
            \010011101101\n\
            \001010110100\n\
            \011011000011\n\
            \111110000110\n\
            \111100100011\n\
            \010010110010\n\
            \000101111111\n\
            \000001010111\n\
            \001110111010\n\
            \101010111110\n\
            \100110000010\n\
            \101011110111\n\
            \101100110100\n\
            \010001111011\n\
            \110110001010\n\
            \111001110100\n\
            \111101011100\n\
            \010011010011\n\
            \000000111100\n\
            \110110010100\n\
            \110000000110\n\
            \110101111010\n\
            \100010100110\n\
            \101100110101\n\
            \100110110111\n\
            \100110000111\n\
            \011101110111\n\
            \101100001000\n\
            \001000100000\n\
            \001010101010\n\
            \010111111111\n\
            \101110001100\n\
            \100001001110\n\
            \111011110111\n\
            \110110111000\n\
            \010010011011\n\
            \001111100111\n\
            \001110000010\n\
            \101110000100\n\
            \111100011111\n\
            \001100101011\n\
            \110111000001\n\
            \110101000111\n\
            \010101010110\n\
            \000001001101\n\
            \111000111011\n\
            \101011100111\n\
            \101100000011\n\
            \000111100101\n\
            \010000101111\n\
            \110010100100\n\
            \001011000111\n\
            \010100110000\n\
            \011111000001\n\
            \010110001001\n\
            \010111001100\n\
            \000111101100\n\
            \010111000110\n\
            \101011111101\n\
            \001011100001\n\
            \110110001000\n\
            \010101101011\n\
            \101100001111\n\
            \101110100001\n\
            \000000111110\n\
            \110010010101\n\
            \101000001100\n\
            \101001000011\n\
            \101001110110\n\
            \110000111101\n\
            \101111111100\n\
            \100100000111\n\
            \010111010111\n\
            \100111110010\n\
            \101101101000\n\
            \000100010000\n\
            \000000100000\n\
            \011011111011\n\
            \100111101110\n\
            \111101110101\n\
            \100100110111\n\
            \100011100001\n\
            \100010101010\n\
            \011001100110\n\
            \110001001001\n\
            \111111101000\n\
            \010011010111\n\
            \111110001100\n\
            \110101011001\n\
            \111101110001\n\
            \111011001101\n\
            \001001001101\n\
            \001010010000\n\
            \101001111000\n\
            \100001010000\n\
            \111010001110\n\
            \011001100111\n\
            \111000101100\n\
            \101100100110\n\
            \111001001011\n\
            \010111010100\n\
            \111001010100\n\
            \001101111101\n\
            \011100111011\n\
            \110001010111\n\
            \110111010111\n\
            \000101001000\n\
            \111100100010\n\
            \011000111011\n\
            \101001010000\n\
            \011101000110\n\
            \011101010110\n\
            \111111111100\n\
            \100101010111\n\
            \001101111001\n\
            \011100111100\n\
            \100101110010\n\
            \111101001101\n\
            \111100110000\n\
            \001000100100\n\
            \001100111010\n\
            \011101101010\n\
            \110101101000\n\
            \011111100000\n\
            \011010111110\n\
            \011010011011\n\
            \001101010101\n\
            \111110110100\n\
            \110001111100\n\
            \110000011100\n\
            \111010110111\n\
            \011111001101\n\
            \011101010001\n\
            \111100101100\n\
            \000100001101\n\
            \101001110010\n\
            \000010100101\n\
            \110110001001\n\
            \001001111101\n\
            \011110101001\n\
            \100010111100\n\
            \111010001010\n\
            \111010010000\n\
            \001000101001\n\
            \101100000001\n\
            \000100100101\n\
            \100101101101\n\
            \101010001111\n\
            \110010110101\n\
            \111010010010\n\
            \000001011000\n\
            \010000110010\n\
            \001011001011\n\
            \100110000101\n\
            \001110100110\n\
            \000100000000\n\
            \000110001110\n\
            \000111011010\n\
            \100010101101\n\
            \110011110111\n\
            \010001010111\n\
            \111100011101\n\
            \001110100010\n\
            \011101101011\n\
            \110101101101\n\
            \111010011101\n\
            \111010100111\n\
            \110010001010\n\
            \011011100111\n\
            \111111010010\n\
            \011011000101\n\
            \000111000110\n\
            \100101110111\n\
            \110111101010\n\
            \110010101010\n\
            \101000110101\n\
            \110000001100\n\
            \000110111100\n\
            \100000101011\n\
            \100110111001\n\
            \101011111100\n\
            \101000100110\n\
            \011101101101\n\
            \011110000111\n\
            \100101010101\n\
            \111111101001\n\
            \010000101101\n\
            \111000110001\n\
            \000100110001\n\
            \010011101001\n\
            \011101100010\n\
            \100111001110\n\
            \000101101001\n\
            \010011100111\n\
            \111100111010\n\
            \111010011111\n\
            \101111001101\n\
            \011101010010\n\
            \000100011010\n\
            \010011110001\n\
            \001011011000\n\
            \000100111100\n\
            \110011110001\n\
            \000011010111\n\
            \011110011010\n\
            \010100111100\n\
            \000000000100\n\
            \100100011100\n\
            \000100010011\n\
            \000001001111\n\
            \110100001011\n\
            \001100100111\n\
            \100010111010\n\
            \110111111001\n\
            \010001101110\n\
            \101100101110\n\
            \101100001100\n\
            \100100000100\n\
            \101001110001\n\
            \101110101100\n\
            \010111001110\n\
            \101111000101\n\
            \100011001001\n\
            \100000000101\n\
            \111010110100\n\
            \011111001010\n\
            \101011001101\n\
            \100110100110\n\
            \101001000010\n\
            \111111101101\n\
            \100011101001\n\
            \100101110110\n\
            \110001100000\n\
            \111011101000\n\
            \000101110111\n\
            \000110100001\n\
            \010001000110\n\
            \001000010110\n\
            \000100001011\n\
            \001100101111\n\
            \011000110111\n\
            \000111111000\n\
            \100100111101\n\
            \000010111111\n\
            \000001111100\n\
            \001011111011\n\
            \001000000010\n\
            \110100110000\n\
            \000101100001\n\
            \001111011001\n\
            \001010100010\n\
            \110001101110\n\
            \111111010101\n\
            \101000001111\n\
            \011011101000\n\
            \000110011110\n\
            \001011001010\n\
            \111111001101\n\
            \001001001100\n\
            \111000011110\n\
            \101110101000\n\
            \101010000110\n\
            \011011010000\n\
            \010001011000\n\
            \010010000111\n\
            \010010110011\n\
            \111010101011\n\
            \001101111010\n\
            \101110111011\n\
            \000101000010\n\
            \001101111111\n\
            \010111000111\n\
            \101011011110\n\
            \011000010100\n\
            \010011010001\n\
            \100011011001\n\
            \100011000111\n\
            \100001011111\n\
            \000001011100\n\
            \111011000000\n\
            \100110111110\n\
            \011001000001\n\
            \110000110110\n\
            \001110111100\n\
            \011001101001\n\
            \011000010111\n\
            \110001111010\n\
            \110010011001\n\
            \111010010111\n\
            \001110000011\n\
            \110010010000\n\
            \010110110011\n\
            \000101000100\n\
            \011111010101\n\
            \010110011100\n\
            \010100001111\n\
            \000100000001\n\
            \101010110111\n\
            \100100001011\n\
            \001101000010\n\
            \011100000111\n\
            \100110101010\n\
            \100011101011\n\
            \001000110100"

input = (map (map digitToInt) (lines realData))

positionalSumsAcc :: [Int] -> [[Int]] -> [Int]
positionalSumsAcc acc [] = acc
positionalSumsAcc acc (x:xs) = positionalSumsAcc (zipWith (+) acc x) xs

positionalSums :: [[Int]] -> [Int]
positionalSums x = positionalSumsAcc (take (length x) [0, 0..]) x

gammaRate :: [[Int]] -> Int
gammaRate x = intFromReversedBinaryArray (reverse (map boolToInt (map (> ((length x) `div` 2)) (positionalSums x))))

epsilonRate :: [[Int]] -> Int
epsilonRate x = intFromReversedBinaryArray (reverse (map boolToInt (map (< ((length x) `div` 2)) (positionalSums x))))

powerConsumption :: [[Int]] -> Int 
powerConsumption x = (gammaRate x) * (epsilonRate x)

boolToInt :: Bool -> Int 
boolToInt True = 1
boolToInt False = 0

intFromReversedBinaryArray :: [Int] -> Int 
intFromReversedBinaryArray [] = 0
intFromReversedBinaryArray (x:xs) = x + (2 * (intFromReversedBinaryArray xs))

filterByMostCommonFirstElement :: [[Int]] -> [[Int]]
filterByMostCommonFirstElement [] = []
filterByMostCommonFirstElement ls = filter (\e -> (head e) == mcfe) ls
  where mcfe = mostCommonFirstElement ls

filterByLeastCommonFirstElement :: [[Int]] -> [[Int]]
filterByLeastCommonFirstElement [] = []
filterByLeastCommonFirstElement ls = filter (\e -> (head e) == lcfe) ls
  where lcfe = leastCommonFirstElement ls

mostCommonFirstElement :: [[Int]] -> Int 
mostCommonFirstElement ls = if (fst lengths) > (snd lengths) then 0 else 1
  where sorted = partition (== 0) (map head ls)
        lengths = (length (fst sorted), length (snd sorted))

leastCommonFirstElement :: [[Int]] -> Int 
leastCommonFirstElement ls = if (fst lengths) <= (snd lengths) then 0 else 1
  where sorted = partition (== 0) (map head ls)
        lengths = (length (fst sorted), length (snd sorted))

{-getMostCommonGuy :: [[Int]] -> [Int]
getMostCommonGuy [] = []
getMostCommonGuy [x] = x
getMostCommonGuy ls = getMostCommonGuy (map tail (filterByMostCommonFirstElement ls))
-}

getMostCommonGuy :: ([Int], [[Int]]) -> ([Int] , [[Int]])
getMostCommonGuy( ans, [] ) = ( ans, [] )
getMostCommonGuy( ans, [x]) = ( ans ++ x, [])
getMostCommonGuy( ans, ls ) = getMostCommonGuy (( ans ++ [(mostCommonFirstElement ls)]), map tail (filterByMostCommonFirstElement ls))

getLeastCommonGuy :: ([Int], [[Int]]) -> ([Int] , [[Int]])
getLeastCommonGuy( ans, [] ) = ( ans, [] )
getLeastCommonGuy( ans, [x]) = ( ans ++ x, [])
getLeastCommonGuy( ans, ls ) = getLeastCommonGuy (( ans ++ [(leastCommonFirstElement ls)]), map tail (filterByLeastCommonFirstElement ls))

oxygenGeneratorRating :: [[Int]] -> Int 
oxygenGeneratorRating ls = intFromReversedBinaryArray( reverse( fst (getMostCommonGuy ([], ls))))

co2ScrubberRating :: [[Int]] -> Int 
co2ScrubberRating ls = intFromReversedBinaryArray( reverse( fst (getLeastCommonGuy ([], ls))))

part2Answer :: [[Int]] -> Int
part2Answer ls = (oxygenGeneratorRating ls) * (co2ScrubberRating ls)