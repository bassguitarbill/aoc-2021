input = "forward 5\n\
\down 5\n\
\forward 8\n\
\up 3\n\
\down 8\n\
\forward 2"

realInput = "forward 2\n\
\down 9\n\
\up 6\n\
\forward 1\n\
\down 5\n\
\down 7\n\
\down 9\n\
\forward 9\n\
\down 8\n\
\up 7\n\
\forward 2\n\
\up 6\n\
\forward 4\n\
\down 5\n\
\down 9\n\
\up 1\n\
\down 9\n\
\forward 8\n\
\forward 6\n\
\forward 6\n\
\forward 5\n\
\forward 9\n\
\up 3\n\
\up 5\n\
\forward 1\n\
\down 4\n\
\down 7\n\
\forward 2\n\
\up 3\n\
\down 8\n\
\forward 1\n\
\down 2\n\
\forward 3\n\
\up 1\n\
\up 1\n\
\up 7\n\
\forward 5\n\
\up 8\n\
\forward 8\n\
\forward 8\n\
\down 6\n\
\forward 1\n\
\forward 5\n\
\forward 4\n\
\forward 6\n\
\forward 5\n\
\down 6\n\
\down 9\n\
\forward 9\n\
\down 8\n\
\forward 6\n\
\down 5\n\
\forward 9\n\
\up 3\n\
\up 1\n\
\down 8\n\
\down 7\n\
\down 9\n\
\forward 7\n\
\down 8\n\
\down 9\n\
\down 5\n\
\down 3\n\
\forward 1\n\
\forward 6\n\
\down 1\n\
\forward 9\n\
\down 5\n\
\forward 7\n\
\up 2\n\
\down 8\n\
\forward 1\n\
\down 4\n\
\down 9\n\
\down 4\n\
\up 5\n\
\forward 4\n\
\forward 6\n\
\forward 1\n\
\down 3\n\
\forward 1\n\
\down 6\n\
\up 5\n\
\up 4\n\
\forward 6\n\
\forward 1\n\
\forward 1\n\
\down 2\n\
\up 4\n\
\up 3\n\
\up 2\n\
\up 6\n\
\down 6\n\
\forward 1\n\
\down 8\n\
\forward 1\n\
\up 6\n\
\forward 7\n\
\down 5\n\
\forward 4\n\
\forward 6\n\
\down 4\n\
\forward 4\n\
\down 4\n\
\down 4\n\
\forward 2\n\
\forward 8\n\
\down 5\n\
\down 1\n\
\down 8\n\
\up 5\n\
\up 8\n\
\down 5\n\
\forward 4\n\
\down 6\n\
\up 7\n\
\forward 2\n\
\down 3\n\
\forward 2\n\
\forward 2\n\
\down 9\n\
\down 3\n\
\up 6\n\
\forward 8\n\
\up 2\n\
\up 9\n\
\forward 4\n\
\down 1\n\
\down 5\n\
\forward 4\n\
\down 2\n\
\down 3\n\
\forward 5\n\
\down 4\n\
\forward 7\n\
\up 4\n\
\forward 6\n\
\up 8\n\
\forward 1\n\
\up 9\n\
\down 4\n\
\forward 2\n\
\down 1\n\
\forward 7\n\
\down 3\n\
\down 2\n\
\forward 5\n\
\down 3\n\
\down 9\n\
\down 9\n\
\up 5\n\
\forward 2\n\
\down 8\n\
\up 9\n\
\forward 4\n\
\down 3\n\
\forward 3\n\
\forward 6\n\
\up 2\n\
\forward 3\n\
\down 1\n\
\down 1\n\
\down 1\n\
\forward 7\n\
\forward 4\n\
\forward 7\n\
\down 5\n\
\down 6\n\
\down 2\n\
\forward 6\n\
\down 3\n\
\up 6\n\
\forward 4\n\
\down 8\n\
\up 1\n\
\forward 8\n\
\down 2\n\
\down 5\n\
\forward 4\n\
\down 9\n\
\forward 2\n\
\forward 2\n\
\down 3\n\
\forward 3\n\
\down 1\n\
\forward 2\n\
\down 7\n\
\forward 3\n\
\forward 9\n\
\up 9\n\
\forward 6\n\
\forward 2\n\
\down 1\n\
\down 5\n\
\forward 6\n\
\forward 6\n\
\down 3\n\
\up 3\n\
\forward 9\n\
\down 7\n\
\down 2\n\
\down 4\n\
\down 7\n\
\forward 5\n\
\up 4\n\
\forward 8\n\
\down 5\n\
\forward 7\n\
\down 7\n\
\up 7\n\
\down 8\n\
\forward 9\n\
\up 5\n\
\forward 1\n\
\down 2\n\
\forward 5\n\
\down 9\n\
\forward 3\n\
\down 5\n\
\forward 8\n\
\forward 3\n\
\up 5\n\
\down 2\n\
\up 3\n\
\forward 2\n\
\up 1\n\
\up 5\n\
\down 8\n\
\forward 2\n\
\down 5\n\
\up 4\n\
\up 5\n\
\up 2\n\
\forward 9\n\
\forward 6\n\
\down 9\n\
\up 9\n\
\forward 6\n\
\forward 4\n\
\forward 3\n\
\forward 7\n\
\up 1\n\
\down 2\n\
\down 6\n\
\down 1\n\
\forward 8\n\
\down 1\n\
\forward 6\n\
\down 8\n\
\forward 8\n\
\down 7\n\
\down 6\n\
\down 5\n\
\forward 2\n\
\up 8\n\
\up 6\n\
\up 5\n\
\down 1\n\
\forward 1\n\
\down 1\n\
\down 5\n\
\forward 7\n\
\forward 3\n\
\down 1\n\
\forward 5\n\
\forward 5\n\
\forward 8\n\
\down 1\n\
\up 2\n\
\down 6\n\
\up 6\n\
\forward 6\n\
\forward 6\n\
\down 3\n\
\forward 9\n\
\up 4\n\
\forward 4\n\
\down 6\n\
\up 1\n\
\forward 6\n\
\down 2\n\
\down 5\n\
\down 2\n\
\down 6\n\
\up 5\n\
\down 1\n\
\down 1\n\
\forward 3\n\
\forward 7\n\
\forward 3\n\
\up 2\n\
\down 8\n\
\down 4\n\
\down 1\n\
\down 5\n\
\down 1\n\
\down 9\n\
\forward 6\n\
\down 6\n\
\down 4\n\
\down 6\n\
\down 8\n\
\forward 4\n\
\down 6\n\
\down 7\n\
\forward 8\n\
\down 4\n\
\up 4\n\
\down 1\n\
\forward 1\n\
\forward 4\n\
\forward 1\n\
\up 9\n\
\down 7\n\
\forward 7\n\
\down 4\n\
\forward 1\n\
\up 4\n\
\forward 4\n\
\down 5\n\
\down 7\n\
\forward 5\n\
\forward 7\n\
\forward 1\n\
\forward 1\n\
\forward 9\n\
\forward 9\n\
\up 3\n\
\forward 4\n\
\down 2\n\
\forward 9\n\
\up 8\n\
\forward 3\n\
\up 5\n\
\down 3\n\
\down 8\n\
\forward 8\n\
\down 6\n\
\forward 1\n\
\down 6\n\
\down 6\n\
\up 9\n\
\down 2\n\
\forward 8\n\
\up 9\n\
\down 7\n\
\up 9\n\
\up 8\n\
\up 1\n\
\forward 6\n\
\forward 9\n\
\down 2\n\
\forward 8\n\
\down 1\n\
\up 4\n\
\forward 4\n\
\forward 7\n\
\up 2\n\
\forward 4\n\
\down 5\n\
\forward 3\n\
\down 2\n\
\down 7\n\
\down 4\n\
\down 2\n\
\up 5\n\
\down 5\n\
\down 5\n\
\down 4\n\
\up 1\n\
\forward 7\n\
\down 6\n\
\forward 5\n\
\forward 1\n\
\down 4\n\
\up 9\n\
\down 5\n\
\forward 7\n\
\forward 5\n\
\down 6\n\
\down 3\n\
\down 9\n\
\down 1\n\
\forward 6\n\
\up 2\n\
\down 7\n\
\down 3\n\
\down 6\n\
\up 3\n\
\down 4\n\
\down 4\n\
\forward 9\n\
\down 3\n\
\forward 2\n\
\down 9\n\
\down 8\n\
\up 4\n\
\down 2\n\
\forward 2\n\
\down 5\n\
\down 4\n\
\down 4\n\
\down 2\n\
\forward 6\n\
\down 3\n\
\forward 1\n\
\down 4\n\
\forward 7\n\
\down 5\n\
\up 4\n\
\down 6\n\
\forward 8\n\
\down 6\n\
\forward 2\n\
\forward 4\n\
\forward 5\n\
\forward 7\n\
\forward 4\n\
\forward 5\n\
\down 8\n\
\down 7\n\
\forward 3\n\
\forward 5\n\
\up 7\n\
\forward 1\n\
\down 4\n\
\forward 5\n\
\forward 4\n\
\forward 4\n\
\down 5\n\
\down 8\n\
\forward 8\n\
\down 1\n\
\down 1\n\
\down 5\n\
\up 5\n\
\forward 6\n\
\down 6\n\
\forward 3\n\
\forward 4\n\
\forward 7\n\
\forward 4\n\
\down 8\n\
\forward 2\n\
\down 4\n\
\forward 4\n\
\down 1\n\
\up 2\n\
\forward 6\n\
\up 1\n\
\down 7\n\
\down 9\n\
\forward 7\n\
\forward 2\n\
\up 3\n\
\down 2\n\
\down 9\n\
\down 5\n\
\up 7\n\
\forward 1\n\
\forward 8\n\
\down 8\n\
\up 3\n\
\down 3\n\
\forward 9\n\
\up 4\n\
\down 5\n\
\up 5\n\
\down 1\n\
\up 8\n\
\forward 9\n\
\down 3\n\
\up 6\n\
\forward 6\n\
\forward 1\n\
\down 1\n\
\forward 9\n\
\down 8\n\
\forward 8\n\
\down 6\n\
\up 9\n\
\down 4\n\
\up 3\n\
\up 9\n\
\forward 2\n\
\down 2\n\
\down 2\n\
\forward 3\n\
\down 2\n\
\forward 5\n\
\forward 4\n\
\up 8\n\
\forward 9\n\
\up 7\n\
\forward 2\n\
\down 5\n\
\down 6\n\
\forward 8\n\
\up 7\n\
\forward 4\n\
\forward 3\n\
\up 5\n\
\down 8\n\
\forward 3\n\
\up 2\n\
\down 3\n\
\forward 6\n\
\down 9\n\
\down 2\n\
\down 6\n\
\down 2\n\
\forward 7\n\
\forward 5\n\
\forward 7\n\
\down 8\n\
\forward 2\n\
\down 2\n\
\forward 8\n\
\up 8\n\
\forward 4\n\
\forward 3\n\
\up 5\n\
\down 3\n\
\forward 3\n\
\up 8\n\
\up 7\n\
\down 4\n\
\down 1\n\
\forward 2\n\
\down 1\n\
\up 6\n\
\up 4\n\
\down 3\n\
\up 1\n\
\forward 7\n\
\forward 7\n\
\forward 7\n\
\forward 8\n\
\down 1\n\
\forward 5\n\
\down 6\n\
\forward 9\n\
\forward 7\n\
\forward 7\n\
\down 4\n\
\up 4\n\
\down 6\n\
\down 9\n\
\up 4\n\
\up 2\n\
\up 6\n\
\forward 4\n\
\up 4\n\
\up 6\n\
\down 2\n\
\forward 4\n\
\down 9\n\
\forward 9\n\
\forward 9\n\
\down 1\n\
\forward 7\n\
\down 2\n\
\down 7\n\
\down 8\n\
\down 8\n\
\down 9\n\
\up 9\n\
\down 5\n\
\forward 5\n\
\forward 7\n\
\forward 4\n\
\down 7\n\
\forward 8\n\
\forward 1\n\
\down 8\n\
\up 9\n\
\down 7\n\
\forward 9\n\
\forward 4\n\
\forward 8\n\
\down 9\n\
\forward 4\n\
\down 3\n\
\forward 3\n\
\down 1\n\
\down 1\n\
\down 2\n\
\up 5\n\
\down 2\n\
\down 1\n\
\down 8\n\
\forward 3\n\
\up 2\n\
\forward 7\n\
\down 3\n\
\down 8\n\
\down 1\n\
\forward 4\n\
\forward 7\n\
\down 5\n\
\forward 6\n\
\down 6\n\
\down 2\n\
\forward 6\n\
\down 3\n\
\up 4\n\
\down 7\n\
\forward 7\n\
\up 1\n\
\up 9\n\
\down 1\n\
\down 2\n\
\down 8\n\
\down 7\n\
\up 1\n\
\forward 7\n\
\down 2\n\
\forward 4\n\
\forward 6\n\
\forward 9\n\
\down 6\n\
\forward 2\n\
\up 8\n\
\down 2\n\
\up 2\n\
\up 5\n\
\down 8\n\
\up 6\n\
\down 9\n\
\forward 6\n\
\down 8\n\
\down 6\n\
\down 1\n\
\up 7\n\
\up 6\n\
\down 8\n\
\forward 2\n\
\up 7\n\
\forward 5\n\
\forward 7\n\
\forward 7\n\
\up 5\n\
\forward 2\n\
\down 9\n\
\up 2\n\
\up 8\n\
\up 2\n\
\down 3\n\
\down 7\n\
\forward 9\n\
\down 3\n\
\up 9\n\
\forward 8\n\
\up 8\n\
\forward 4\n\
\forward 8\n\
\forward 6\n\
\up 1\n\
\down 3\n\
\up 1\n\
\down 1\n\
\forward 2\n\
\forward 1\n\
\forward 4\n\
\forward 7\n\
\up 8\n\
\down 9\n\
\up 2\n\
\down 7\n\
\forward 4\n\
\down 3\n\
\forward 4\n\
\forward 2\n\
\down 9\n\
\forward 8\n\
\forward 5\n\
\forward 3\n\
\down 6\n\
\forward 4\n\
\forward 4\n\
\forward 9\n\
\forward 4\n\
\up 5\n\
\down 7\n\
\up 6\n\
\forward 5\n\
\down 5\n\
\forward 4\n\
\down 5\n\
\forward 7\n\
\forward 3\n\
\forward 5\n\
\down 5\n\
\forward 4\n\
\down 5\n\
\up 4\n\
\down 8\n\
\up 3\n\
\down 3\n\
\up 5\n\
\forward 4\n\
\forward 5\n\
\down 6\n\
\forward 6\n\
\forward 1\n\
\forward 8\n\
\down 6\n\
\down 9\n\
\up 5\n\
\forward 2\n\
\forward 8\n\
\up 6\n\
\down 6\n\
\forward 2\n\
\down 8\n\
\forward 7\n\
\forward 7\n\
\down 5\n\
\forward 5\n\
\forward 8\n\
\forward 1\n\
\down 4\n\
\down 2\n\
\down 5\n\
\up 4\n\
\forward 3\n\
\forward 5\n\
\down 4\n\
\down 7\n\
\down 4\n\
\up 9\n\
\up 6\n\
\forward 1\n\
\down 8\n\
\up 8\n\
\up 9\n\
\forward 2\n\
\forward 1\n\
\down 6\n\
\forward 6\n\
\down 4\n\
\forward 7\n\
\up 2\n\
\up 1\n\
\forward 4\n\
\down 1\n\
\forward 8\n\
\forward 3\n\
\up 7\n\
\up 5\n\
\down 1\n\
\forward 8\n\
\forward 6\n\
\up 6\n\
\forward 9\n\
\down 5\n\
\down 9\n\
\forward 2\n\
\down 3\n\
\up 1\n\
\up 7\n\
\down 1\n\
\forward 8\n\
\up 9\n\
\down 1\n\
\down 5\n\
\down 7\n\
\down 5\n\
\down 5\n\
\down 5\n\
\up 9\n\
\forward 9\n\
\forward 7\n\
\forward 4\n\
\forward 6\n\
\down 5\n\
\down 3\n\
\forward 9\n\
\forward 1\n\
\down 1\n\
\down 8\n\
\up 4\n\
\down 9\n\
\forward 9\n\
\up 1\n\
\down 5\n\
\forward 8\n\
\up 6\n\
\forward 3\n\
\down 6\n\
\up 8\n\
\down 7\n\
\forward 3\n\
\forward 6\n\
\down 7\n\
\forward 6\n\
\forward 4\n\
\forward 4\n\
\down 4\n\
\forward 6\n\
\forward 5\n\
\down 6\n\
\forward 6\n\
\down 7\n\
\forward 6\n\
\forward 3\n\
\up 4\n\
\up 2\n\
\up 6\n\
\down 2\n\
\down 8\n\
\forward 5\n\
\forward 1\n\
\up 4\n\
\forward 7\n\
\forward 9\n\
\up 6\n\
\down 7\n\
\down 3\n\
\up 5\n\
\forward 5\n\
\down 8\n\
\up 1\n\
\down 1\n\
\down 3\n\
\down 2\n\
\down 1\n\
\forward 5\n\
\down 3\n\
\down 5\n\
\forward 7\n\
\forward 9\n\
\down 3\n\
\forward 7\n\
\forward 5\n\
\forward 4\n\
\forward 2\n\
\forward 7\n\
\forward 8\n\
\forward 6\n\
\down 8\n\
\forward 5\n\
\forward 6\n\
\forward 6\n\
\down 8\n\
\down 2\n\
\forward 4\n\
\down 7\n\
\forward 6\n\
\down 7\n\
\down 4\n\
\forward 6\n\
\up 6\n\
\forward 4\n\
\forward 9\n\
\forward 2\n\
\forward 3\n\
\forward 1\n\
\down 8\n\
\down 3\n\
\forward 4\n\
\up 3\n\
\forward 7\n\
\forward 1\n\
\down 7\n\
\down 8\n\
\forward 1\n\
\up 8\n\
\forward 8\n\
\up 8\n\
\down 5\n\
\forward 6\n\
\down 8\n\
\down 4\n\
\down 9\n\
\up 1\n\
\down 3\n\
\forward 6\n\
\down 6\n\
\forward 7\n\
\forward 3\n\
\down 6\n\
\down 6\n\
\forward 4\n\
\down 4\n\
\down 1\n\
\down 8\n\
\forward 2\n\
\forward 8\n\
\forward 8\n\
\down 6\n\
\forward 9\n\
\down 9\n\
\down 5\n\
\down 5\n\
\forward 7\n\
\down 1\n\
\forward 1\n\
\down 1\n\
\down 6\n\
\down 1\n\
\forward 1\n\
\up 6\n\
\up 9\n\
\forward 5\n\
\down 6\n\
\forward 8\n\
\forward 6\n\
\down 7\n\
\forward 1\n\
\forward 4\n\
\forward 9\n\
\forward 2\n\
\forward 4\n\
\down 2\n\
\forward 1\n\
\forward 8\n\
\down 1\n\
\down 1\n\
\forward 4\n\
\down 5\n\
\down 3\n\
\down 9\n\
\down 2\n\
\up 8\n\
\down 7\n\
\down 1\n\
\down 9\n\
\forward 2\n\
\forward 2\n\
\up 3\n\
\forward 3\n\
\down 3\n\
\forward 5\n\
\forward 9\n\
\down 7\n\
\up 7\n\
\down 9\n\
\forward 3\n\
\forward 7\n\
\down 1\n\
\forward 8\n\
\down 8\n\
\forward 1\n\
\down 8\n\
\down 6\n\
\forward 2\n\
\down 3\n\
\down 1\n\
\down 8\n\
\forward 3\n\
\up 5\n\
\down 7\n\
\up 2\n\
\up 8\n\
\forward 5\n\
\up 7\n\
\down 6\n\
\up 7\n\
\down 9\n\
\forward 5\n\
\up 4\n\
\forward 9\n\
\down 5\n\
\up 7\n\
\down 2\n\
\up 2\n\
\up 7\n\
\forward 5\n\
\down 6\n\
\forward 4\n\
\down 4\n\
\down 3\n\
\forward 2\n\
\up 2\n\
\down 5\n\
\forward 8\n\
\down 3\n\
\up 7\n\
\down 1\n\
\down 7\n\
\forward 7\n\
\forward 4\n\
\forward 7\n\
\down 2\n\
\down 9\n\
\down 6\n\
\down 9\n\
\down 2\n\
\down 9\n\
\down 7\n\
\down 5\n\
\forward 4\n\
\up 5\n\
\up 7\n\
\forward 2\n\
\forward 7\n\
\down 3\n\
\down 3\n\
\forward 4"

{-data Command = Forward Int | Up Int | Down Int deriving(Show)
data Position = Position Int Int deriving(Show)

executeCommand :: Position -> Command -> Position
executeCommand (Position horiz depth) (Forward amount)  = Position (horiz + amount) depth
executeCommand (Position horiz depth) (Up amount)       = Position horiz (depth - amount)
executeCommand (Position horiz depth) (Down amount)     = Position horiz (depth + amount)

parseCommand :: String -> Command
parseCommand cmd
  | head (words cmd) == "forward" = Forward (read (last (words cmd)))
  | head (words cmd) == "up"      = Up      (read (last (words cmd)))
  | head (words cmd) == "down"    = Down    (read (last (words cmd)))
  | otherwise = error "Yikes"

finalPosition = foldl executeCommand (Position 0 0) (map parseCommand (lines realInput))

getAnswer :: Position -> Int
getAnswer (Position horiz depth) = horiz * depth

finalAnswer = getAnswer finalPositiondata Command = Forward Int | Up Int | Down Int deriving(Show)
-}

data Command = Forward Int | Up Int | Down Int deriving(Show)
data Position = Position Int Int Int deriving(Show)

executeCommand :: Position -> Command -> Position
executeCommand (Position horiz depth aim) (Forward amount)  = Position (horiz + amount) (depth + (amount * aim)) aim
executeCommand (Position horiz depth aim) (Up amount)       = Position horiz depth (aim - amount)
executeCommand (Position horiz depth aim) (Down amount)     = Position horiz depth (aim + amount)

parseCommand :: String -> Command
parseCommand cmd
  | head (words cmd) == "forward" = Forward (read (last (words cmd)))
  | head (words cmd) == "up"      = Up      (read (last (words cmd)))
  | head (words cmd) == "down"    = Down    (read (last (words cmd)))
  | otherwise = error "Yikes"

finalPosition = foldl executeCommand (Position 0 0 0) (map parseCommand (lines realInput))

getAnswer :: Position -> Int
getAnswer (Position horiz depth _) = horiz * depth

finalAnswer = getAnswer finalPosition